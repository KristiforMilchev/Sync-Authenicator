<mxfile host="65bd71144e">
    <diagram id="Y-M546CChRrJm27xp74t" name="Page-1">
        <mxGraphModel dx="5188" dy="1974" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" background="#363636" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="PzvEJw_CK41en-DEElVB-10" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-1" target="PzvEJw_CK41en-DEElVB-8" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-1" value="Website" style="swimlane;whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="300" y="860" width="200" height="200" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-2" value="Login" style="rounded=1;whiteSpace=wrap;html=1;" parent="PzvEJw_CK41en-DEElVB-1" vertex="1">
                    <mxGeometry x="70" y="160" width="60" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-3" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="PzvEJw_CK41en-DEElVB-1" vertex="1">
                    <mxGeometry x="35" y="120" width="130" height="15" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-4" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="PzvEJw_CK41en-DEElVB-1" vertex="1">
                    <mxGeometry x="35" y="70" width="130" height="15" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-5" value="&lt;div&gt;Email&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;rounded=1;" parent="PzvEJw_CK41en-DEElVB-1" vertex="1">
                    <mxGeometry x="35" y="40" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-6" value="Password" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;rounded=1;" parent="PzvEJw_CK41en-DEElVB-1" vertex="1">
                    <mxGeometry x="35" y="90" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-12" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-7" target="PzvEJw_CK41en-DEElVB-11" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-7" value="Authentication Module" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="340" y="650" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-9" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-8" target="PzvEJw_CK41en-DEElVB-7" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-8" value="&lt;div&gt;Sign in&lt;/div&gt;&lt;div&gt;Reqeuest&lt;br&gt;&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="360" y="750" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-11" target="PzvEJw_CK41en-DEElVB-15" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-11" value="" style="triangle;whiteSpace=wrap;html=1;rotation=-90;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="370" y="530" width="60" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-21" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-14" target="PzvEJw_CK41en-DEElVB-20" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-14" value="&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; IF&lt;/div&gt;&lt;div&gt;Paired&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="375" y="560" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-122" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-15" target="PzvEJw_CK41en-DEElVB-117" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-15" value="Await confirmation" style="ellipse;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="360" y="370" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-20" target="PzvEJw_CK41en-DEElVB-23" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-44" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-20" target="PzvEJw_CK41en-DEElVB-43" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-20" value="Generate Pair QR code button" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="40" y="815" width="180" height="95" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-22" value="Else" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="270" y="545" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-23" value="Qr code structure " style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="70" y="657.5" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-32" value="" style="swimlane;startSize=0;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-480" y="580" width="430" height="200" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-33" value="&lt;div style=&quot;color: rgb(225, 228, 232); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-weight: normal; font-size: 14px; line-height: 19px;&quot; align=&quot;left&quot;&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;&amp;nbsp; &quot;email&quot;:&quot;poko@contoso.com&quot;,&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;&amp;nbsp; &quot;message&quot;:&quot;e62df3c1e8b44ced8b3492d9eed73924&quot;,&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;&amp;nbsp; &quot;url&quot;:&quot;http://localhost:7246&quot;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rounded=1;" parent="PzvEJw_CK41en-DEElVB-32" vertex="1">
                    <mxGeometry x="20" y="45" width="420" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-34" value="Qr Payload" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-320" y="540" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-35" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-33" target="PzvEJw_CK41en-DEElVB-23" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-51" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.415;entryDx=0;entryDy=0;entryPerimeter=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-37" target="PzvEJw_CK41en-DEElVB-32" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-37" value="&lt;div&gt;&lt;font style=&quot;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;&quot;&gt;Email:&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;&quot;&gt;The account to be associated with the sync authentication&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;fontColor=default;" parent="1" vertex="1">
                    <mxGeometry x="-750" y="540" width="167.5" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-50" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-38" target="PzvEJw_CK41en-DEElVB-32" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-38" value="&lt;div&gt;&lt;font color=&quot;#fafafa&quot;&gt;Message:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#fafafa&quot;&gt;A randomly generated plain text message&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=none;fontColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="-750" y="635" width="167.5" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-52" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.002;entryY=0.59;entryDx=0;entryDy=0;entryPerimeter=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-41" target="PzvEJw_CK41en-DEElVB-32" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-41" value="&lt;div&gt;&lt;font color=&quot;#ffffff&quot;&gt;Url:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#ffffff&quot;&gt;The current website domain name default request router/&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=none;fontColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="-750" y="730" width="167.5" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-45" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.909;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-43" target="PzvEJw_CK41en-DEElVB-32" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-43" value="Copy raw data button in case QR on the page fails" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-130" y="832.5" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-68" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-57" target="PzvEJw_CK41en-DEElVB-67" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-57" value="PairDevice (TFRequest payload)" style="whiteSpace=wrap;html=1;labelBackgroundColor=#030303;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1110" y="342.5" width="220" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-58" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" target="PzvEJw_CK41en-DEElVB-57" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1080" y="870" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-123" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-61" target="PzvEJw_CK41en-DEElVB-119" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-61" value="&lt;div style=&quot;color: rgb(225, 228, 232); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-weight: normal; font-size: 14px; line-height: 19px;&quot; align=&quot;left&quot;&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;&amp;nbsp; &quot;email&quot;:&quot;steve@contoso.com&quot;,&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;&amp;nbsp; &quot;message&quot;:&quot;Hello&amp;nbsp; World&quot;,&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;&amp;nbsp; &quot;signed&quot;:&quot;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;e62df...&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;e62924&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;labelBackgroundColor=#FFFFFF;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="840" y="447.5" width="320" height="235" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-124" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-64" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-10" y="230" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1380" y="130"/>
                            <mxPoint x="-10" y="130"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-64" value="Decode Message signature" style="shape=internalStorage;whiteSpace=wrap;html=1;backgroundOutline=1;labelBackgroundColor=#030303;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1360" y="530" width="230" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-69" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-67" target="PzvEJw_CK41en-DEElVB-64" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-71" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-67" target="PzvEJw_CK41en-DEElVB-70" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-67" value="derive public key" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=#030303;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1407.5" y="322.5" width="135" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-74" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-70" target="PzvEJw_CK41en-DEElVB-72" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-70" value="&lt;div&gt;Update user database &lt;br&gt;&lt;/div&gt;&lt;div&gt;Add public key to the account entity&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;labelBackgroundColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1630" y="333.75" width="190" height="97.5" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-103" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-72" target="PzvEJw_CK41en-DEElVB-101" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-72" value="Accounts DB" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;labelBackgroundColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1910" y="280" width="60" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-78" value="Random Message generator" style="shape=internalStorage;whiteSpace=wrap;html=1;backgroundOutline=1;labelBackgroundColor=#030303;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1552.5" y="725" width="230" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-83" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-80" target="PzvEJw_CK41en-DEElVB-82" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-80" value="string RequestSignature()" style="whiteSpace=wrap;html=1;labelBackgroundColor=#030303;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1342.5" y="920" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-81" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" target="PzvEJw_CK41en-DEElVB-80" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1080" y="960" as="sourcePoint"/>
                        <Array as="points">
                            <mxPoint x="1080" y="950"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-84" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-82" target="PzvEJw_CK41en-DEElVB-78" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-86" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-82" target="PzvEJw_CK41en-DEElVB-85" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-82" value="&lt;div&gt;Generate &lt;br&gt;&lt;/div&gt;&lt;div&gt;new message&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1600" y="890" width="135" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-85" value="Update expected message signatures colection" style="ellipse;whiteSpace=wrap;html=1;labelBackgroundColor=#030303;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1870" y="875" width="167.5" height="150" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-92" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-89" target="PzvEJw_CK41en-DEElVB-91" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-89" value="string SignTwoFactor(TFRequest payload)" style="whiteSpace=wrap;html=1;labelBackgroundColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1342.5" y="1025" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-90" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" target="PzvEJw_CK41en-DEElVB-89" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1080" y="1050" as="sourcePoint"/>
                        <Array as="points">
                            <mxPoint x="1080" y="1055"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-93" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-91" target="PzvEJw_CK41en-DEElVB-85" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-95" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-91" target="PzvEJw_CK41en-DEElVB-94" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-91" value="Get expected message" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=#030303;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1627.5" y="1070" width="142.5" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-96" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-94" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="2100" y="700" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-94" value="Get expected message and match if it's the same as the TFRequest message.&lt;br&gt;&lt;br&gt;Pass in the expected and the Signed from the TFRequst to the MessageDecoder" style="whiteSpace=wrap;html=1;labelBackgroundColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="1559.3700000000001" y="1240" width="278.75" height="135" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-98" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-97" target="PzvEJw_CK41en-DEElVB-64" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-100" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-97" target="PzvEJw_CK41en-DEElVB-99" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-97" value="&lt;div&gt;Expected,&lt;/div&gt;&lt;div&gt;Signed&lt;br&gt;&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=#FFFFFF;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="2060" y="620" width="90" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-102" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-99" target="PzvEJw_CK41en-DEElVB-101" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-99" value="out public key" style="whiteSpace=wrap;html=1;labelBackgroundColor=#FFFFFF;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="2200" y="645" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-104" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-101" target="PzvEJw_CK41en-DEElVB-105" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="2390" y="1100" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="2410" y="505"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-101" value="&lt;div&gt;Get user &lt;br&gt;&lt;/div&gt;&lt;div&gt;public key from DB&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="2195" y="442.5" width="130" height="125" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-110" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-105" target="PzvEJw_CK41en-DEElVB-109" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-113" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-105" target="PzvEJw_CK41en-DEElVB-108" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-105" value="&lt;div&gt;Check if&lt;/div&gt;&lt;div&gt;&amp;nbsp;derived == db.UserTwoFaKey&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="2305" y="1100" width="210" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-107" value="True" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="2505" y="1125" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-108" value="2FA approved" style="whiteSpace=wrap;html=1;labelBackgroundColor=#FFFFFF;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="2600" y="1150" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-109" value="2FA denied" style="whiteSpace=wrap;html=1;labelBackgroundColor=#FFFFFF;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="2135" y="1150" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-111" value="False" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="2255" y="1140" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-114" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-117" target="PzvEJw_CK41en-DEElVB-118" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-115" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-117" target="PzvEJw_CK41en-DEElVB-120" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-116" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-117" target="PzvEJw_CK41en-DEElVB-121" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-117" value="&lt;font color=&quot;#ffffff&quot;&gt;2FA Controller&lt;/font&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;labelBackgroundColor=#030303;rounded=1;fontColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="660" y="890" width="150" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-118" value="&lt;font color=&quot;#f2f2f2&quot;&gt;bool PairDevice(TFRequest payload)&lt;/font&gt;" style="whiteSpace=wrap;html=1;labelBackgroundColor=#030303;rounded=1;fontColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="890" y="850" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-119" value="TFRequest" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="960" y="750" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-120" value="&lt;font color=&quot;#fcfcfc&quot;&gt;string RequestSignature()&lt;/font&gt;" style="whiteSpace=wrap;html=1;labelBackgroundColor=#030303;rounded=1;fontColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="890" y="940" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-121" value="&lt;font color=&quot;#fcfcfc&quot;&gt;string SignTwoFactor(TFRequest payload)&lt;/font&gt;" style="whiteSpace=wrap;html=1;labelBackgroundColor=none;rounded=1;fontColor=#030303;" parent="1" vertex="1">
                    <mxGeometry x="890" y="1030" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-131" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-126" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-220" y="260" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-134" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-126" target="PzvEJw_CK41en-DEElVB-133" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-126" value="&lt;span style=&quot;background-color: rgb(15 , 15 , 15)&quot;&gt;Signature Decoder&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=#FFFFFF;" parent="1" vertex="1">
                    <mxGeometry x="-70" y="230" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-127" value="Data" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;labelBackgroundColor=#FFFFFF;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-410" y="200" width="190" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-128" value="Plain Message (String)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;labelBackgroundColor=#2A2A2A;rounded=1;fontColor=#F7F7F7;labelBorderColor=none;" parent="PzvEJw_CK41en-DEElVB-127" vertex="1">
                    <mxGeometry y="30" width="190" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-129" value="&lt;font&gt;Signed Message (String)&lt;/font&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;labelBackgroundColor=#2A2A2A;rounded=1;fontColor=#F7F7F7;labelBorderColor=none;" parent="PzvEJw_CK41en-DEElVB-127" vertex="1">
                    <mxGeometry y="60" width="190" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-132" value="Input data" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-180" y="230" width="80" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-136" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-133" target="PzvEJw_CK41en-DEElVB-135" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-133" value="&lt;div style=&quot;color: rgb(225, 228, 232); background-color: rgb(36, 41, 46); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-weight: normal; font-size: 14px; line-height: 19px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #e1e4e8;&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;/// Recover exactly sender address from personal signature and message&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;///&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;/// @param {String} personal signature - the signature that was signed typed personal sign from the below message&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;/// @param {Uint8List} message - the message of signature&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #6a737d;&quot;&gt;/// @returns {String} - wallet address which signed the above message to the above signature&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=#FFFFFF;" parent="1" vertex="1">
                    <mxGeometry x="-540" y="-100" width="540" height="220" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-138" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-135" target="PzvEJw_CK41en-DEElVB-137" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-135" value="&lt;font color=&quot;#ffffff&quot;&gt;calculateRecoverySig(List&amp;lt;int&amp;gt; message) the signature string to List&amp;lt;int&amp;gt; bytes&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=none;" parent="1" vertex="1">
                    <mxGeometry x="-950" y="-20" width="250" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-140" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-137" target="PzvEJw_CK41en-DEElVB-139" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-145" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-137" target="PzvEJw_CK41en-DEElVB-144" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-137" value="" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=none;strokeColor=default;fillColor=default;" parent="1" vertex="1">
                    <mxGeometry x="-1202.5" y="17.5" width="125" height="65" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-143" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-139" target="PzvEJw_CK41en-DEElVB-142" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-139" value="HashPrefixMessage(byte[] message)" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=#FFFFFF;" parent="1" vertex="1">
                    <mxGeometry x="-1232.5" y="-185" width="155" height="85" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-142" value="&lt;div&gt;&lt;span style=&quot;&quot;&gt;new byte[]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;bytePrefix = 0x19.HexToByteArray&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;textBytePrefix = UtfEncode(&quot;Etthreum Signed Message:\n&quot; +message.Lenght&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;return new List&amp;lt;byte&amp;gt;{bytePrefix, textBytePrefix, message}.ToArra();&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=none;" parent="1" vertex="1">
                    <mxGeometry x="-1020" y="-340" width="310" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-147" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-144" target="PzvEJw_CK41en-DEElVB-146" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-163" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-144" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-1397.5" y="180" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-144" value="&lt;span style=&quot;background-color: rgb(43 , 43 , 43)&quot;&gt;ExtractECDSASignature(singed)&lt;/span&gt;" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=#FFFFFF;fillColor=default;" parent="1" vertex="1">
                    <mxGeometry x="-1490" y="-52.5" width="185" height="135" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-149" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-146" target="PzvEJw_CK41en-DEElVB-148" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-146" value="convertTobytes" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=none;" parent="1" vertex="1">
                    <mxGeometry x="-1457.5" y="-260" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-148" value="&lt;pre style=&quot;background-color:#262626;color:#d0d0d0;font-family:'JetBrains Mono',monospace;font-size:9.8pt;&quot;&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] bytes = &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;IsNullOrEmpty&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(value))&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    bytes = &lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;Empty&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;else&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;string_length = value.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;Length&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;character_index = value.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;StartsWith&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#c9a26d;&quot;&gt;&quot;0x&quot;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color:#e1bfff;&quot;&gt;StringComparison&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;font-weight:bold;&quot;&gt;Ordinal&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;) &lt;/span&gt;? &lt;span style=&quot;color:#ed94c0;&quot;&gt;2 &lt;/span&gt;: &lt;span style=&quot;color:#ed94c0;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;// Does the string define leading HEX indicator '0x'. Adjust starting index accordingly.               &lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;number_of_characters = string_length - character_index;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;add_leading_zero = &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;0 &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;!= number_of_characters % &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        add_leading_zero = &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;true&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        number_of_characters += &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;; &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;// Leading '0' has been striped from the string presentation.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    bytes = &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;new byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[number_of_characters / &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;]; &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;// Initialize our byte array to hold the converted string.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;write_index = &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(add_leading_zero)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        bytes[write_index++] = &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;FromCharacterToByte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(value[character_index], character_index);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        character_index += &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;read_index = character_index; read_index &amp;lt; value.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;Length&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;; read_index += &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;upper = &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;FromCharacterToByte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(value[read_index], read_index, &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;4&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;lower = &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;FromCharacterToByte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(value[read_index + &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;], read_index + &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        bytes[write_index++] = (&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;) (upper | lower);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return &lt;/span&gt;bytes&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1810" y="-1050" width="560" height="660" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-152" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-151" target="PzvEJw_CK41en-DEElVB-146" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-154" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-151" target="PzvEJw_CK41en-DEElVB-153" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-151" value="ExtractECDASignature(byte[] signature)" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=#000000;" parent="1" vertex="1">
                    <mxGeometry x="-1800" y="-280" width="230" height="150" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-156" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-153" target="PzvEJw_CK41en-DEElVB-155" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-153" value="&lt;pre style=&quot;background-color:#262626;color:#d0d0d0;font-family:'JetBrains Mono',monospace;font-size:9.8pt;&quot;&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;public static &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECDSASignature &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;ExtractECDSASignature&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] signatureArray)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt; &lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;v = signatureArray[&lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;64&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;];&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(v == &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;0 &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;|| v == &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        v = (&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)(v + &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;27&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;r = &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;new byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;];&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;Array&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Copy&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(signatureArray, r, &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;s = &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;new byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;];&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;Array&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Copy&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(signatureArray, &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;, s, &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECDSASignatureFactory&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;FromComponents&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(r, s, v);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-2450" y="-322.5" width="560" height="270" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-160" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-155" target="PzvEJw_CK41en-DEElVB-159" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-155" value="FromComponents(r,s,v)" style="whiteSpace=wrap;html=1;labelBackgroundColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-2255" y="22.5" width="170" height="67.5" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-159" value="&lt;pre style=&quot;background-color:#262626;color:#d0d0d0;font-family:'JetBrains Mono',monospace;font-size:9.8pt;&quot;&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;public static &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECDSASignature &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;FromComponents&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] r, &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] s, &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;v)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;signature = &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;FromComponents&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(r, s);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    signature.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;V &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;= &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] { v };&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;signature;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-2450" y="140" width="560" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-162" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-161" target="PzvEJw_CK41en-DEElVB-159" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-161" value="&lt;pre style=&quot;background-color:#262626;color:#d0d0d0;font-family:'JetBrains Mono',monospace;font-size:9.8pt;&quot;&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;public static &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECDSASignature &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;FromComponents&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] r, &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] s)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECDSASignature&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;BigInteger&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;, r), &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;BigInteger&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;, s));&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-2450" y="355" width="560" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-165" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-164" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-1440" y="360" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-164" value="&lt;pre style=&quot;background-color:#262626;color:#d0d0d0;font-family:'JetBrains Mono',monospace;font-size:9.8pt;&quot;&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;public virtual string &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;EcRecover&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] hashMessage, &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;string &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;signature)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;ecdaSignature = &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;ExtractEcdsaSignature&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(signature);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;EthECKey&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;RecoverFromSignature&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(ecdaSignature, hashMessage).&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;GetPublicAddress&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;();&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1720" y="170" width="560" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-167" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="PzvEJw_CK41en-DEElVB-166" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-1450" y="610" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-166" value="&lt;pre style=&quot;background-color:#262626;color:#d0d0d0;font-family:'JetBrains Mono',monospace;font-size:9.8pt;&quot;&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;public static &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;EthECKey &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;RecoverFromSignature&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;EthECDSASignature &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;signature, &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] hash)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;EthECKey&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECKey&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;RecoverFromSignature&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;GetRecIdFromV&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(signature.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;V&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;), signature.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;ECDSASignature&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;, hash,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;));&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1730" y="355" width="560" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-168" value="&lt;pre style=&quot;background-color:#262626;color:#d0d0d0;font-family:'JetBrains Mono',monospace;font-size:9.8pt;&quot;&gt;  &lt;span style=&quot;color:#6c95eb;&quot;&gt;public static &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECKey &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;RecoverFromSignature&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;recId, &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECDSASignature &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;sig, &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;byte&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;[] message, &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;bool &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;compressed)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(recId &amp;lt; &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;throw new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ArgumentException&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#c9a26d;&quot;&gt;&quot;recId should be positive&quot;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(sig.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;R&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;SignValue &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&amp;lt; &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;throw new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ArgumentException&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#c9a26d;&quot;&gt;&quot;r should be positive&quot;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(sig.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;S&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;SignValue &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&amp;lt; &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;throw new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ArgumentException&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#c9a26d;&quot;&gt;&quot;s should be positive&quot;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(message == &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;throw new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ArgumentNullException&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#c9a26d;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;message&lt;/span&gt;&lt;span style=&quot;color:#c9a26d;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;#if &lt;/span&gt;NETCOREAPP3_1 || NET5_0&lt;br&gt;            &lt;span style=&quot;color:#787878;&quot;&gt;if (EthECKey.SignRecoverable)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#787878;&quot;&gt;            {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#787878;&quot;&gt;                SecpECDSASignature.TryCreateFromDer(sig.ToDER(), out var signature);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#787878;&quot;&gt;                var recoverable = new SecpRecoverableECDSASignature(signature, recId);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#787878;&quot;&gt;                ECPubKey.TryRecover(Context.Instance, recoverable, message, out var pubKey);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#787878;&quot;&gt;                return new ECKey(pubKey.ToBytes(compressed), false);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#787878;&quot;&gt;            }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#787878;&quot;&gt;            else&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#787878;&quot;&gt;            {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;#endif&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;                var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;curve = &lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;Secp256k1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;// 1.0 For j from 0 to h   (h == recId here and the loop is outside this function)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //   1.1 Let x = r + jn&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;n = curve.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;N&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;i = &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;BigInteger&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;ValueOf&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;((&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;long&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)recId / &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;x = sig.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;R&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Add&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(i.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Multiply&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(n));&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;//   1.2. Convert the integer x to an octet string X of length mlen using the conversion routine&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //        specified in Section 2.3.7, where mlen = &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;font-family:'DejaVu Sans Mono',monospace;&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;(log2 p)/8&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;font-family:'DejaVu Sans Mono',monospace;&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt; or mlen = &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;font-family:'DejaVu Sans Mono',monospace;&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;m/8&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;font-family:'DejaVu Sans Mono',monospace;&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //   1.3. Convert the octet string (16 set binary digits)||X to an elliptic curve point R using the&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //        conversion routine specified in Section 2.3.4. If this conversion routine outputs invalid, then&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //        do another iteration of Step 1.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                // More concisely, what these points mean is to use X as a compressed public key.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //using bouncy and Q value of Point&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(x.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;CompareTo&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;PRIME&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;) &amp;gt;= &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return null&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;// Compressed keys require you to know an extra bit of data about the y-coord as there are two possibilities.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                // So it's encoded in the recId.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;R = &lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;DecompressKey&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(x, (recId &amp;amp; &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;) == &lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;//   1.4. If nR != point at infinity, then do another iteration of Step 1 (callers responsibility).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;!&lt;span style=&quot;color:#bdbdbd;&quot;&gt;R.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Multiply&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(n).&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;IsInfinity&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return null&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;//   1.5. Compute e from M using Steps 2 and 3 of ECDSA signature verification.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;e = &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;BigInteger&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ed94c0;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;, message);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;//   1.6. For k from 1 to 2 do the following.   (loop is outside this function via iterating recId)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //   1.6.1. Compute a candidate public key as:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //               Q = mi(r) * (sR - eG)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                // Where mi(x) is the modular multiplicative inverse. We transform this into the following:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //               Q = (mi(r) * s ** R) + (mi(r) * -e ** G)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                // Where -e is the modular additive inverse of e, that is z such that z + e = 0 (mod n). In the above equation&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                // ** is point multiplication and + is point addition (the EC group operator).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                //&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                // We can find the additive inverse by subtracting e from zero then taking the mod. For example the additive&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                // inverse of 3 modulo 11 is 8 because 3 + 8 mod 11 = 0, and -3 mod 11 = 8.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#85c46c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;eInv = &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;BigInteger&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;Zero&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Subtract&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(e).&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Mod&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(n);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;rInv = sig.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;R&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;ModInverse&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(n);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;srInv = rInv.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Multiply&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(sig.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;S&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;).&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Mod&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(n);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;eInvrInv = rInv.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Multiply&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(eInv).&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Mod&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(n);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;var &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;q = &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECAlgorithms&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;SumOfTwoMultiplies&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(curve.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;G&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;, eInvrInv, R, srInv);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                q = q.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;Normalize&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;();&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(compressed)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                    q = &lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;Secp256k1&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;Curve&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;CreatePoint&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(q.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;XCoord&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;ToBigInteger&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(), q.&lt;/span&gt;&lt;span style=&quot;color:#66c3cc;&quot;&gt;YCoord&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;ToBigInteger&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;());&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECKey&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(q.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;GetEncoded&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;true&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;), &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;return new &lt;/span&gt;&lt;span style=&quot;color:#c191ff;&quot;&gt;ECKey&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(q.&lt;/span&gt;&lt;span style=&quot;color:#39cc8f;&quot;&gt;GetEncoded&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;(), &lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;#if &lt;/span&gt;NETCOREAPP3_1 || NET5_0&lt;br&gt;            &lt;span style=&quot;color:#787878;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;#endif&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#6c95eb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#bdbdbd;background-color:#472b63;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1880" y="610" width="560" height="1350" as="geometry"/>
                </mxCell>
                <mxCell id="PzvEJw_CK41en-DEElVB-169" value="&lt;div&gt;&lt;font style=&quot;font-size: 25px;&quot;&gt;Example of the internal workings of a recovery using the .net core&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 25px;&quot;&gt;&amp;nbsp; Nethreum library for more information how to integrate read the Nethrerum documentation&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-850" y="310" width="1030" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="2" value="&lt;span style=&quot;&quot;&gt;EcRecover(byte[] message, string signature)&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#030303;fontColor=#FAFAFA;" vertex="1" parent="1">
                    <mxGeometry x="-1170" y="35" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="2FA denied" style="whiteSpace=wrap;html=1;labelBackgroundColor=#000000;rounded=1;" vertex="1" parent="1">
                    <mxGeometry x="2135" y="1150" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="2FA approved" style="whiteSpace=wrap;html=1;labelBackgroundColor=#000000;rounded=1;" vertex="1" parent="1">
                    <mxGeometry x="2600" y="1150" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="&lt;div&gt;Expected,&lt;/div&gt;&lt;div&gt;Signed&lt;br&gt;&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=#000000;rounded=1;" vertex="1" parent="1">
                    <mxGeometry x="2051.25" y="620" width="90" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="8" value="out public key" style="whiteSpace=wrap;html=1;labelBackgroundColor=#000000;rounded=1;" vertex="1" parent="1">
                    <mxGeometry x="2191.25" y="645" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="11" value="HashPrefixMessage(byte[] message)" style="whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=none;" vertex="1" parent="1">
                    <mxGeometry x="-1241.25" y="-185" width="155" height="85" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>